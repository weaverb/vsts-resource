#!/bin/bash

source ../src/common.sh

function updateWitHistoryWithExternalGit_Should_Return_Correct_JSON() {
    local _account="testaccount"
    local _collection="TestCollection"
    local _apiVersion="1.0"
    local _witId="1"
    local _commitSha="commit-sha"
    local _cloneUrl="http://www.google.com"
    local _vstsUser="test"
    local _vstsPass="test"

    expected='{"id":"123"}'

    # mock curl: fixtures/curl/2969d33f6a429d3c84480d0ee62d83c4
    actual=$(updateWitHistoryWithExternalGit "${_account}" "${_collection}" "${_witId}" "${_apiVersion}" "${_commitSha}" "${_cloneUrl}" "${_vstsUser}" "${_vstsPass}")

    # Assert
    _equals "updateWitHistoryWithExternalGit_Should_Return_Correct_Url" "${expected}" "${actual}"
}


function _equals() {
    local _method="${1}"
    local _expected="${2}"
    local _actual="${3}"

    if [[ "$_actual" == *"$_expected" ]]; then
        echo -e "${_method} \e[32mPassed\e[0m"
    else
        echo -e "${_method} \e[31mFailed\e[0m"
        echo "expected result: ${_expected}"
        echo "actual result: ${_actual} "
        exit 1
    fi   
}